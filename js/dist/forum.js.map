{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@capybash/magicslider/webpack/bootstrap","webpack://@capybash/magicslider/webpack/runtime/compat get default export","webpack://@capybash/magicslider/webpack/runtime/define property getters","webpack://@capybash/magicslider/webpack/runtime/hasOwnProperty shorthand","webpack://@capybash/magicslider/external root \"flarum.core.compat['forum/app']\"","webpack://@capybash/magicslider/external root \"flarum.core.compat['common/extend']\"","webpack://@capybash/magicslider/external root \"flarum.core.compat['forum/components/IndexPage']\"","webpack://@capybash/magicslider/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@capybash/magicslider/external root \"flarum.core.compat['common/Component']\"","webpack://@capybash/magicslider/./src/forum/components/MagicSlider.tsx","webpack://@capybash/magicslider/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@capybash/magicslider/./src/forum/index.tsx"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/components/IndexPage'];","function _setPrototypeOf(t, e) {\n  return _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function (t, e) {\n    return t.__proto__ = e, t;\n  }, _setPrototypeOf(t, e);\n}\nexport { _setPrototypeOf as default };","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","import Component, { ComponentAttrs } from 'flarum/common/Component';\n\ntype Slide = { image: string; link?: string; newTab?: boolean };\n\ninterface MagicSliderAttrs extends ComponentAttrs {\n  slides: Slide[];\n  heightDesktop: number;\n  heightMobile: number;\n  padding: number;\n  radius: number;\n  autoplayMs: number;\n}\n\nexport default class MagicSlider extends Component<MagicSliderAttrs> {\n  private index = 0;\n  private interval?: number;\n  private touchStartX: number | null = null;\n\n  oncreate(vnode: any) {\n    const ms = Number(vnode.attrs.autoplayMs || 0);\n    if (vnode.attrs.slides.length > 1 && ms > 0) {\n      this.interval = window.setInterval(() => {\n        this.next(vnode.attrs.slides.length);\n        m.redraw();\n      }, ms);\n    }\n  }\n\n  onremove() {\n    if (this.interval) window.clearInterval(this.interval);\n  }\n\n  private next(len: number) {\n    this.index = (this.index + 1) % len;\n  }\n\n  private prev(len: number) {\n    this.index = (this.index - 1 + len) % len;\n  }\n\n  private onPointerDown(e: PointerEvent) {\n    this.touchStartX = e.clientX ?? 0;\n  }\n\n  private onPointerUp(e: PointerEvent, len: number) {\n    if (this.touchStartX === null) return;\n    const dx = (e.clientX ?? 0) - this.touchStartX;\n    this.touchStartX = null;\n\n    const threshold = 40;\n    if (Math.abs(dx) > threshold) {\n      if (dx < 0) this.next(len);\n      else this.prev(len);\n      m.redraw();\n    }\n  }\n\n  view(vnode: any) {\n    const { slides, heightDesktop, heightMobile, padding, radius } = vnode.attrs;\n    if (!slides.length) return null;\n\n    const offsetPct = -(this.index * 100);\n\n    return (\n      <div className=\"MagicSlider-wrap\" style={{ padding: `${padding}px` }}>\n        <div\n          className=\"MagicSlider\"\n          style={{\n            borderRadius: `${radius}px`,\n            ['--ms-h-desktop' as any]: `${heightDesktop}px`,\n            ['--ms-h-mobile' as any]: `${heightMobile}px`,\n          }}\n          onpointerdown={(e: any) => this.onPointerDown(e)}\n          onpointerup={(e: any) => this.onPointerUp(e, slides.length)}\n        >\n          <div className=\"MagicSlider-track\" style={{ transform: `translateX(${offsetPct}%)` }}>\n            {slides.map((s: Slide, i: number) => (\n              <a\n                key={i}\n                className=\"MagicSlide\"\n                href={s.link || '#'}\n                target={s.link ? (s.newTab ? '_blank' : '_self') : undefined}\n                rel={s.link && s.newTab ? 'noopener' : undefined}\n                style={{ backgroundImage: `url('${s.image}')` }}\n                onclick={(e: MouseEvent) => {\n                  if (!s.link) e.preventDefault();\n                }}\n              />\n            ))}\n          </div>\n\n          {slides.length > 1 && (\n            <>\n              <button\n                className=\"MagicSlider-btn prev\"\n                aria-label=\"Previous\"\n                onclick={() => {\n                  this.prev(slides.length);\n                }}\n              >\n                <i className=\"fas fa-chevron-left\"></i>\n              </button>\n\n              <button\n                className=\"MagicSlider-btn next\"\n                aria-label=\"Next\"\n                onclick={() => {\n                  this.next(slides.length);\n                }}\n              >\n                <i className=\"fas fa-chevron-right\"></i>\n              </button>\n\n              <div className=\"MagicSlider-dots\">\n                {slides.map((_, i) => (\n                  <button\n                    key={i}\n                    className={'dot' + (this.index === i ? ' is-active' : '')}\n                    aria-label={`Slide ${i + 1}`}\n                    onclick={() => {\n                      this.index = i;\n                    }}\n                  />\n                ))}\n              </div>\n            </>\n          )}\n        </div>\n      </div>\n    );\n  }\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nfunction _inheritsLoose(t, o) {\n  t.prototype = Object.create(o.prototype), t.prototype.constructor = t, setPrototypeOf(t, o);\n}\nexport { _inheritsLoose as default };","import app from 'flarum/forum/app';\nimport { override } from 'flarum/common/extend';\nimport IndexPage from 'flarum/forum/components/IndexPage';\nimport MagicSlider from './components/MagicSlider';\n\ntype Slide = { image: string; link?: string; newTab?: boolean | string };\n\nfunction isTrue(v: unknown): boolean {\n  return v === true || v === 1 || v === '1' || v === 'true';\n}\n\nfunction isSingleTagPage(): boolean {\n  const p1 = (typeof location !== 'undefined' && location.pathname) || '';\n  if (p1 && /(?:^|\\/)t(?:\\/|$)/.test(p1)) return true;\n  if (p1 && /(?:^|\\/)tags(?:\\/|$)/.test(p1)) return false;\n\n  const p2 = (window as any)?.m?.route?.get?.() || '';\n  if (p2 && /(?:^|\\/)t(?:\\/|$)/.test(p2)) return true;\n  if (p2 && /(?:^|\\/)tags(?:\\/|$)/.test(p2)) return false;\n\n  return false;\n}\n\napp.initializers.add('capybash-magicslider', () => {\n  override(IndexPage.prototype, 'hero', function (original: any) {\n    const hideOnTagPages = isTrue(app.forum.attribute('capybash-magicslider.hide_on_tag_pages'));\n\n    if (hideOnTagPages && isSingleTagPage()) {\n      return original();\n    }\n\n    const rawSlides = app.forum.attribute<string>('capybash-magicslider.slides') || '[]';\n    let slides: Slide[] = [];\n    try {\n      slides = JSON.parse(rawSlides) as Slide[];\n    } catch {\n      slides = [];\n    }\n\n    const normSlides = slides\n      .filter((s) => s && s.image)\n      .map((s) => ({\n        image: s.image || '',\n        link: s.link || '',\n        newTab: s.newTab === true || s.newTab === 'true',\n      }));\n\n    if (!normSlides.length) return original();\n\n    const heightDesktop = Number(app.forum.attribute('capybash-magicslider.height_desktop') || 260);\n    const heightMobile  = Number(app.forum.attribute('capybash-magicslider.height_mobile') || 200);\n    const padding       = Number(app.forum.attribute('capybash-magicslider.padding') || 0);\n    const radius        = Number(app.forum.attribute('capybash-magicslider.radius') || 0);\n    const autoplay      = Number(app.forum.attribute('capybash-magicslider.autoplay') || 0);\n\n    return (\n      <MagicSlider\n        slides={normSlides}\n        heightDesktop={heightDesktop}\n        heightMobile={heightMobile}\n        padding={padding}\n        radius={radius}\n        autoplayMs={autoplay}\n      />\n    );\n  });\n});"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","flarum","core","compat","_setPrototypeOf","t","e","setPrototypeOf","bind","__proto__","MagicSlider","_Component","_this","_len","arguments","length","args","Array","_key","apply","concat","index","interval","touchStartX","create","constructor","_proto","oncreate","vnode","_this2","ms","Number","attrs","autoplayMs","slides","this","window","setInterval","next","m","redraw","onremove","clearInterval","len","prev","onPointerDown","_e$clientX","clientX","onPointerUp","_e$clientX2","dx","Math","abs","view","_ref","_this3","_vnode$attrs","heightDesktop","heightMobile","padding","radius","offsetPct","className","style","borderRadius","onpointerdown","onpointerup","transform","map","s","i","href","link","target","newTab","undefined","rel","backgroundImage","image","onclick","preventDefault","'['","_","Component","app","add","override","IndexPage","original","v","attribute","_window","p1","location","pathname","test","p2","route","isSingleTagPage","rawSlides","JSON","parse","_unused","normSlides","filter","autoplay"],"sourceRoot":""}